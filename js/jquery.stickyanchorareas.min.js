/* @preserve
 * Sticky Anchor Areas
 * Make elements sticky to the top of the document
 * and keep anchor scrolling support from both links and the window.location.hash
 * Copyright 2013 Robin Poort
 * http://www.robinpoort.com
 */
"use strict";(function($){$('<div id="canBrowserhandleFixedPosition" style="position:fixed;width:0;height:0;overflow:hidden;top:100px;"></div>').prependTo("body");var theOffset=$("#canBrowserhandleFixedPosition").offset().top;if(theOffset>=100){theOffset=true}else{theOffset=false}$("#canBrowserhandleFixedPosition").remove();$.stickyAnchorArea=function(element,options){var defaults={},plugin=this;plugin.settings={};var $element=$(element),element=element;plugin.init=function(){plugin.settings=$.extend({},defaults,options);var stickyElement=$element,stickyElementHeight=$element.outerHeight(),stickyElementZindex=$element.css("z-index"),scrollUntilContainerClass="";if(plugin.settings.scrollFrom){var scrollFromContainer=plugin.settings.scrollFrom}if(plugin.settings.scrollUntil){var scrollUntilContainer=plugin.settings.scrollUntil;scrollUntilContainerClass=" scroll_until_"+scrollUntilContainer.substring(1)}$.fn.fixedPosition=function(scrollFromHeight,stickyElementWidth){this.css({position:"fixed",top:scrollFromHeight,height:"auto",width:stickyElementWidth})};$.fn.unFixedPosition=function(){this.removeAttr("style")};stickyElement.wrap('<div class="stickyParent'+scrollUntilContainerClass+'"></div>');function makeSticky(){var scrollTop=Math.ceil($(window).scrollTop()),stickyElementParent=stickyElement.parent(".stickyParent"),stickyElementOffset=Math.ceil(stickyElement.parent(".stickyParent").offset().top),stickyElementHeight=$element.outerHeight(),stickyElementWidth=stickyElementParent.width(),scrollFromHeight="0",windowWidth=$(window).width(),windowHeight=$(window).height();if(plugin.settings.scrollFrom){var scrollFromHeight=Math.ceil($(scrollFromContainer).outerHeight()),scrollUntilNewTop=scrollTop+scrollFromHeight}if(plugin.settings.scrollUntil){if(plugin.settings.scrollFrom&&scrollFromHeight<=windowHeight){var scrollUntil=Math.ceil($(scrollUntilContainer).offset().top)-scrollFromHeight,scrollUntilPosition=scrollUntil-stickyElementOffset+(scrollFromHeight-stickyElementHeight)}else{var scrollUntil=Math.ceil($(scrollUntilContainer).offset().top),scrollUntilPosition=scrollUntil-stickyElementOffset-stickyElementHeight}}if(plugin.settings.stickyFromWidth&&plugin.settings.stickyFromHeight&&(windowWidth>=plugin.settings.stickyFromWidth&&windowHeight>=plugin.settings.stickyFromHeight)||(windowWidth>=plugin.settings.stickyFromWidth&&!plugin.settings.stickyFromHeight||windowHeight>=plugin.settings.stickyFromHeight&&!plugin.settings.stickyFromWidth)||!plugin.settings.stickyFromWidth&&!plugin.settings.stickyFromHeight){if(!stickyElementParent.hasClass("child-to-tall")){stickyElementParent.css({position:"relative",height:stickyElementHeight,"z-index":stickyElementZindex})}if(stickyElementHeight>=windowHeight){var stickyTopOffset=stickyElement.offset().top;stickyElementParent.addClass("child-to-tall");stickyElement.addClass("to-tall")}if(stickyElementHeight>=windowHeight&&stickyElement.css("position")=="fixed"){var stickyTopOffset=stickyElement.offset().top;stickyElementParent.css("position","static").addClass("child-to-tall");stickyElement.css({position:"absolute",top:stickyTopOffset,height:"auto",width:stickyElementWidth}).addClass("to-tall")}else if(scrollTop<=stickyElementParent.offset().top&&stickyElementHeight>=windowHeight){stickyElement.unFixedPosition();if(stickyElement.hasClass("child-to-tall")){stickyElement.removeClass("child-to-tall")}}else if(scrollTop<=stickyElement.offset().top&&stickyElementHeight>=windowHeight&&stickyElement.css("position")=="absolute"){stickyElement.css({position:"absolute",top:scrollTop}).addClass("to-tall")}else if(stickyElementHeight>=windowHeight&&stickyElement.css("position")=="absolute"&&stickyElement.hasClass("to-tall")){stickyElement.css({height:"auto",width:stickyElementWidth})}else if(stickyElementHeight<windowHeight){if(stickyElementParent.hasClass("child-to-tall")){stickyElementParent.removeClass("child-to-tall")}if(stickyElement.hasClass("to-tall")){stickyElement.removeClass("to-tall")}}if(!stickyElement.hasClass("to-tall")){if(scrollTop>stickyElementOffset||stickyElementOffset==0){$(element).fixedPosition(scrollFromHeight,stickyElementWidth)}if(plugin.settings.scrollFrom){if(scrollFromHeight<=windowHeight){if(stickyElementOffset<=scrollUntilNewTop){stickyElement.fixedPosition(scrollFromHeight,stickyElementWidth)}if(stickyElementOffset>scrollUntilNewTop){stickyElement.unFixedPosition()}}else if(scrollTop>stickyElementOffset){stickyElement.fixedPosition(0,stickyElementWidth)}}if(scrollTop<stickyElementOffset&&stickyElementOffset!=0&&(!plugin.settings.scrollFrom||!plugin.settings.scrollFrom)){stickyElement.unFixedPosition()}else if(scrollTop<stickyElementOffset&&scrollFromHeight>=windowHeight){stickyElement.unFixedPosition()}if(plugin.settings.scrollUntil){if(scrollTop>=scrollUntil-stickyElementHeight){stickyElement.css({position:"absolute",top:scrollUntilPosition})}if(scrollTop>=scrollUntil){stickyElement.unFixedPosition()}}}}else{stickyElement.unFixedPosition();if(stickyElementParent.hasClass("child-to-tall")){stickyElementParent.removeClass("child-to-tall")}if(stickyElement.hasClass("to-tall")){stickyElement.removeClass("to-tall")}}if(stickyElement.parent(".stickyParent").height()>stickyElement.outerHeight()){stickyElementParent.css("height",stickyElement.outerHeight())}}$(window).on("ready resize scroll",function(){makeSticky()})};plugin.init()};$.fn.isAfter=function(elem){if(typeof elem=="string")elem=$(elem);return this.add(elem).index(elem)==0};function anchorLink(element){event.preventDefault();var original_target=element,target=$(original_target),scrollTopAmount=Math.ceil(target.offset().top),scrollUntilHeight1=0,scrollUntilHeight2=0,scrollUntilHeight=0;$(".stickyParent").each(function(){if(target.isAfter($(this))){scrollUntilHeight2+=$(this).outerHeight()}if($(this).is('[class*="scroll_until"]')){var scrollUntilClass1=$(this).attr("class").split(" ")[1].replace("scroll_until_",""),scrollUntilClass2=$("."+scrollUntilClass1);if(target.isAfter(scrollUntilClass2)){scrollUntilHeight1+=$(this).outerHeight()}}scrollUntilHeight=scrollUntilHeight2-scrollUntilHeight1});scrollTopAmount-=scrollUntilHeight;window.location.hash=original_target;$("html,body").scrollTop(scrollTopAmount)}if(theOffset==true){$("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var element=$(this).prop("hash");anchorLink(element)}});$(window).load(function(){if(window.location.hash){var element=window.location.hash;anchorLink(element)}})}$.fn.stickyAnchorArea=function(options){return this.each(function(){if(undefined==$(this).data("stickyAnchorArea")){var plugin=new $.stickyAnchorArea(this,options);$(this).data("stickyAnchorArea",plugin)}})}})(jQuery);